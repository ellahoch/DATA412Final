---
title: "gun_law_scorecard_analysis"
author: "Wesley Hoy"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyverse)
```


```{r}
scorecard <- read_csv("data/giffords_gun_law_scorecard_2021.csv") %>%
  mutate(Grade = substr(Grade, 1, 1)) # Remove + and - from grades for easier data analysis
  

head(scorecard)


scorecard %>%
  filter(Grade == "A") %>%
  nrow()

scorecard %>%
  filter(Grade == "B") %>%
  nrow()

scorecard %>%
  filter(Grade == "C") %>%
  nrow()

scorecard %>%
  filter(Grade == "D") %>%
  nrow()

scorecard %>%
  filter(Grade == "F") %>%
  nrow()
```

As you can see, a majority of states in the US have a low gun law rating, according to Giffords Law Center. Now, let's match up their scores to their gun law rank

```{r}
scorecard %>%
  group_by(Grade) %>%
  summarize(Average_Ranking = mean(Gun_Law_Strength_Rank),
            SD_Ranking = sd(Gun_Law_Strength_Rank),
            Average_Death_Rate_Rank = mean(Gun_Death_Rate_Rank),
            SD_Death_Rate_Rank = sd(Gun_Death_Rate_Rank),
            Averate_Death_Rate_Per_100k = mean(Gun_Deaths_Per_100k),
            SD_Death_Rate_Per_100k = sd(Gun_Deaths_Per_100k)) ->
  scorecard_generalized

head(scorecard_generalized)

ggplot(scorecard_generalized, aes(Grade, Average_Ranking, fill = Grade)) +
  geom_bar(stat="identity") +
  coord_flip() +
  labs(y = "Average Ranking", title = "Average Gun Law Strength Rank For Each Grade For States in the US", subtitle = "Data courtesy of Gilfords Law Center")

ggplot(scorecard_generalized, aes(Grade, Average_Death_Rate_Rank, fill = Grade)) +
  geom_bar(stat="identity") +
  coord_flip() +
  labs(y = "Average Ranking For Death Rate", title = "Average Ranking For Death Rate Rank For Each Grade For States in the US", subtitle = "Data courtesy of Gilfords Law Center")

ggplot(scorecard_generalized, aes(Grade, Averate_Death_Rate_Per_100k, fill = Grade)) +
  geom_bar(stat="identity") +
  coord_flip() +
  labs(y = "Average Death Rate Per 100k", title = "Average Death Rate Per 100k Rank For Each Grade For States in the US", subtitle = "Data courtesy of Gilfords Law Center")


```

